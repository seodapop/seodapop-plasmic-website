"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[855],{53032:function(e,t,n){n.d(t,{O:function(){return m}});var r=n(85893),i=n(40168),l=n(42930),s=n(11636),u=n(67294),o=n(32932),a=n(86670);n(57557),n(66996),n(933);let c=(e,t)=>({title:(0,r.jsxs)("em",{children:["No schema found for type ",(0,r.jsx)("code",{children:t})]}),subtitle:(0,r.jsxs)("em",{children:["Document: ",(0,r.jsx)("code",{children:e})]}),media:()=>(0,r.jsx)(i.foC,{})});function d(e){let{layout:t,value:n}=e;return(0,r.jsx)(o.ogX,{...c(n._id,n._type),layout:t})}function f(e,t,n){return!1!==e&&(e||t&&t.icon||n||!1)}function m(e){let{icon:t,id:n,layout:c="default",pressed:m,schemaType:h,selected:p,title:x,value:y,margin:g,marginBottom:j,marginTop:b}=e,v=(0,o.I_y)(),k=(0,o.rq_)(),{ChildLink:_}=(0,a.RL)(),C=(0,o.Dqo)(n),S=!!(h&&h.name&&v.get(h.name)),[w,R]=(0,u.useState)(!1),E=(0,u.useMemo)(()=>y&&(0,l.Si)(y)?h&&S?(0,r.jsx)(a.iJ,{documentPreviewStore:k,icon:f(t,h,i.$lS),layout:c,schemaType:h,value:y,presence:C}):(0,r.jsx)(d,{value:y}):(0,r.jsx)(o.ogX,{status:(0,r.jsx)(s.xv,{muted:!0,children:(0,r.jsx)(i.XCv,{})}),icon:f(t,h,i.ROc),layout:c,title:x}),[k,S,t,c,h,x,y,C]),D=(0,u.useMemo)(()=>function(e){return(0,r.jsx)(_,{...e,childId:n})},[_,n]),M=(0,u.useCallback)(()=>R(!0),[]);return(0,u.useEffect)(()=>R(!1),[p]),(0,r.jsx)(o.oUE,{__unstable_focusRing:!0,as:D,"data-as":"a","data-ui":"PaneItem",margin:g,marginBottom:j,marginTop:b,onClick:M,padding:2,pressed:m,radius:2,selected:p||w,sizing:"border",tabIndex:-1,tone:"inherit",children:E})}},47855:function(e,t,n){n.r(t),n.d(t,{default:function(){return ec}});var r,i,l,s,u,o=n(85893),a=n(67294),c=n(11636),d=n(38993),f=n.n(d),m=n(18446),h=n.n(m),p=n(40168),x=n(94589),y=n(19917),g=n(5014),j=n(83610),b=n(32817),v=n(65583),k=n(30743),_=n(23071),C=n(74727),S=n(9132),w=n(37991),R=n(82649),E=n(69243),D=n(22401),M=n(29127),P=n(42006),T=n(92574),q=n(6222),W=n(28440);n(933);var z=n(86670),I=n(82698),O=n(66996),X=n(42930),B=n(32932),$=n(53032);n(57557),n(81763),n(47037);var L=n(98430),N=n(79878),A=n(56542),Y=n(85092);function Z(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}let K={by:[{field:"_updatedAt",direction:"desc"}]},F={},H=/\b_type\s*==\s*(['"].*?['"]|\$.*?(?:\s|$))|\B(['"].*?['"]|\$.*?(?:\s|$))\s*==\s*_type\b/;function Q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(H);if(!n)return null;let r=(n[1]||n[2]).trim().replace(/^["']|["']$/g,"");if("$"===r[0]){let e=r.slice(1),n=t[e];return"string"==typeof n?n:null}return r}let U=(0,x.ZP)(c.xu)(r||(r=Z(["\n  position: relative;\n"]))),V=(0,x.ZP)(c.xu)(i||(i=Z(["\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n"]))),J=[...Array(30).keys()];function G(e){let{layout:t}=e;return(0,o.jsx)(c.Kq,{padding:2,space:1,children:J.map(e=>(0,o.jsx)(c.Zb,{padding:2,children:(0,o.jsx)(B.ogX,{isPlaceholder:!0,layout:t})},e))})}function ee(e){let{childItemId:t,error:n,filterIsSimpleTypeConstraint:r,hasMaxItems:i,hasSearchQuery:l,isActive:s,isLazyLoading:u,isLoading:d,items:f,layout:m,loadingVariant:h,onListChange:x,onRetry:y,searchInputElement:g,showIcons:j}=e,b=(0,B.I_y)(),{collapsed:v}=(0,z.Cc)(),{collapsed:k,index:_}=(0,z.ec)(),[C,S]=(0,a.useState)(!1),w=(0,a.useCallback)(()=>{d||u||!C||x()},[u,d,x,C]);(0,a.useEffect)(()=>{if(k)return;let e=setTimeout(()=>{S(!0)},0);return()=>{clearTimeout(e)}},[k,f]);let R=(0,a.useCallback)((e,n)=>{let{activeIndex:r}=n,l=(0,B.vsM)(e._id),a=t===l,d=!s&&a,h=s&&a,p=r===f.length-1,x=p&&u,y=p&&i;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)($.O,{icon:!1!==j&&void 0,id:l,layout:m,marginBottom:1,pressed:d,schemaType:b.get(e._type),selected:h,value:e}),x&&(0,o.jsx)(c.kC,{align:"center",justify:"center",padding:4,children:(0,o.jsx)(c.$j,{muted:!0})}),y&&(0,o.jsx)(c.xu,{marginY:1,paddingX:3,paddingY:4,children:(0,o.jsxs)(c.xv,{align:"center",muted:!0,size:1,children:["Displaying a maximum of ",2e3," documents"]})})]})},[t,s,f.length,m,b,j,i,u]),E=(0,a.useMemo)(()=>l?(0,o.jsx)(c.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,o.jsx)(c.W2,{width:1,children:(0,o.jsx)(c.xu,{paddingX:4,paddingY:5,children:(0,o.jsx)(c.xv,{align:"center",muted:!0,children:"No results found"})})})}):(0,o.jsx)(c.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,o.jsx)(c.W2,{width:1,children:(0,o.jsx)(c.xu,{paddingX:4,paddingY:5,children:(0,o.jsx)(c.xv,{align:"center",muted:!0,children:r?"No documents of this type":"No matching documents"})})})}),[r,l]),D=(0,a.useMemo)(()=>{if(!C)return null;if(n)return(0,o.jsx)(c.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,o.jsx)(c.W2,{width:1,children:(0,o.jsxs)(c.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,o.jsx)(c.X6,{as:"h3",children:"Could not fetch list items"}),(0,o.jsxs)(c.xv,{as:"p",children:["Error: ",(0,o.jsx)("code",{children:n.message})]}),y&&(0,o.jsx)(c.xu,{children:(0,o.jsx)(c.zx,{icon:p.bnu,onClick:y,text:"Retry",tone:"primary"})})]})})});if(!d&&0===f.length)return E;if("initial"===h&&d)return(0,o.jsx)(I.Delay,{ms:300,children:(0,o.jsx)(G,{layout:m})});if("spinner"===h&&d)return null;let e="".concat(_,"-").concat(k);return(0,o.jsx)(U,{overflow:"hidden",height:"fill",children:(0,o.jsx)(V,{children:(0,o.jsx)(B.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:"Document list",canReceiveFocus:!0,focusRingOffset:-3,inputElement:g,itemHeight:51,items:f,onEndReached:w,onlyShowSelectionWhenActive:!0,overscan:10,padding:2,paddingBottom:1,renderItem:R,wrapAround:!1},e)})})},[k,n,w,_,d,f,m,h,y,R,g,C]);return(0,o.jsx)(z.Bh,{overflow:v||"initial"===h?"hidden":"auto",children:D})}let et=(0,a.memo)(e=>{let{contentAfter:t,index:n,initialValueTemplates:r=[],menuItemGroups:i=[],menuItems:l=[],setLayout:s,setSortOrder:u,title:d}=e,{features:f}=(0,I.useDeskTool)(),{collapsed:m,isLast:h}=(0,z.ec)(),x=h&&!m?-1:0,y=(0,a.useMemo)(()=>({setLayout:e=>{let{layout:t}=e;s(t)},setSortOrder:e=>{u(e)}}),[s,u]);return(0,o.jsx)(z.hX,{actions:(0,o.jsx)(z.cp,{initialValueTemplateItems:r,actionHandlers:y,menuItemGroups:i,menuItems:l}),backButton:f.backButton&&n>0&&(0,o.jsx)(c.zx,{as:z.hb,"data-as":"a",icon:p.Y4O,mode:"bleed"}),contentAfter:t,tabIndex:x,title:d})});et.displayName="DocumentListPaneHeader";let en=[],er={error:null,onRetry:void 0,result:null},ei={result:null,error:null},el=[],es=(0,x.F4)(l||(l=Z(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]))),eu=(0,x.ZP)(p.L4p)(s||(s=Z(["\n  animation: "," 500ms linear infinite;\n"])),es),eo=(0,x.ZP)(c.Zb)(u||(u=Z(["\n  [data-ui='TextInput'] {\n    border-radius: inherit;\n  }\n"]))),ea=e=>{let{menuItems:t,sortOrderRaw:n,layout:r}=e;return null==t?void 0:t.map(e=>{var t,i,l,s;return(null==(t=e.params)?void 0:t.layout)?{...e,selected:r===(null==(i=e.params)?void 0:i.layout)}:(null==(l=null==e?void 0:e.params)?void 0:l.by)?{...e,selected:h()(null==n?void 0:n.by,(null==(s=null==e?void 0:e.params)?void 0:s.by)||el)}:{...e,selected:!1}})},ec=(0,a.memo)(function(e){let{childItemId:t,index:n,isActive:r,isSelected:i,pane:l,paneKey:s}=e,u=(0,B.I_y)(),{name:d}=(0,B.Lky)(),{defaultLayout:m="default",displayOptions:h,initialValueTemplates:x=el,menuItemGroups:$,menuItems:Z,options:H,title:U}=l,{apiVersion:V,defaultOrdering:J=el,filter:G}=H,es=function(e){let t=(0,a.useRef)(e);return f()(t.current,e)||(t.current=e),t.current}(H.params||F),ec=l.source,ed=(0,a.useMemo)(()=>Q(G,es),[G,es]),ef=(null==h?void 0:h.showIcons)!==!1,[em,eh]=(0,I.useDeskToolSetting)(ed,"layout",m),[ep,ex]=(0,a.useState)(""),[ey,eg]=(0,a.useState)(""),[ej,eb]=(0,a.useState)(null),ev=(0,a.useRef)(!1),ek=(0,a.useMemo)(()=>(null==J?void 0:J.length)>0?{by:J}:K,[J]),[e_,eC]=(0,I.useDeskToolSetting)(ed,"sortOrder",ek),eS=ed&&e_?function(e,t){let n=e.by.map(e=>{if(e.mapWith)return e;let n=function(e,t){let n=O.mL(t),r=e;for(let e of n){if(!r)return;if("string"==typeof e){r=function(e,t){if(!("fields"in e))return;let n=e.fields.find(e=>e.name===t);return n?n.type:void 0}(r,e);continue}let t=(0,X.Fd)(e)||(0,X.dw)(e);if(!t||"array"!==r.jsonType)return;let[n,i]=r.of||[];if(i||!n)return;if(!(0,X.dD)(n)){r=n;continue}let[l,s]=n.to||[];if(s||!l)return;r=l}return r}(t,e.field);return n?!function(e,t){let n=e.type;for(;n;){if(n.name===t||!n.type&&n.jsonType===t)return!0;n=n.type}return!1}(n,"datetime")?"string"===n.jsonType?{...e,mapWith:"lower"}:e:{...e,mapWith:"dateTime"}:e});return n.every((t,n)=>t===e.by[n])?e:{...e,by:n}}(e_,u.get(ed)):e_,ew=(0,B.BoV)(eS),eR=/^_type\s*==\s*['"$]\w+['"]?\s*$/.test(G.trim()),{error:eE,hasMaxItems:eD,isLazyLoading:eM,isLoading:eP,isSearchReady:eT,items:eq,onListChange:eW,onRetry:ez}=function(e){let{filter:t,params:n,sortOrder:r,searchQuery:i}=e,l=(0,B.m85)(B.Dr7),s=(0,B.I_y)(),[u,o]=(0,a.useState)(er),{onRetry:c,error:d,result:f}=u,m=null==f?void 0:f.documents,h=(0,a.useMemo)(()=>m?(0,B.RgL)(m).map(e=>{let t=e.draft||e.published;return{...t,hasPublished:!!e.published,hasDraft:!!e.draft}}):en,[m]),[p,x]=(0,a.useState)(!1),[P,T]=(0,a.useState)(!1),[q,W]=(0,a.useState)(!1),z=(0,a.useMemo)(()=>Q(t,n),[t,n]),I=null===f&&!d,O=(null==m?void 0:m.length)===2e3,X=(0,a.useCallback)(()=>{I||P||q||W(!0)},[I,P,q]),$=(0,a.useCallback)(e=>{var t,n;if(e.error){o(e);return}let r=(null==(n=null==(t=e.result)?void 0:t.documents)?void 0:n.length)||0,i=!e.error&&(null==e?void 0:e.result)===null&&q;if(i){x(!0);return}if(r<100&&0!==r&&!q&&T(!0),(null==e?void 0:e.result)===null){o(t=>({...t.error?e:t}));return}x(!1),o(e)},[q]),Z=(0,a.useMemo)(()=>{let e=new R.x,u=()=>e.next(),o=q?2e3:100,a=r||K;return(function(e){let{client:t,schema:n,sort:r,limit:i,params:l,filter:s,searchQuery:u,staticTypeNames:o}=e,a=r.by,c=null==r?void 0:r.extendedProjection,d=(0,y.P)(()=>t.listen("*[".concat(s,"]"),l,{events:["welcome","mutation","reconnect"],includeResult:!1,visibility:"query"})).pipe((0,g.z)((e,t)=>0===t&&"welcome"!==e.type?(0,j._)(()=>Error("reconnect"===e.type?"Could not establish EventSource connection":'Received unexpected type of first event "'.concat(e.type,'"'))):(0,b.of)(e)),(0,v.B)()),[f,m]=(0,k.u)(d,e=>"welcome"===e.type);return(0,_.T)(f.pipe((0,C.q)(1)),m.pipe((0,S.p)(1e3,w.z,{leading:!0,trailing:!0}))).pipe((0,Y.q)(()=>{let e=o?(0,b.of)(o):t.observable.fetch("array::unique(*[".concat(s,"][]._type)"),l);return e.pipe((0,g.z)(e=>{let r=e.flatMap(e=>n.get(e)||[]),{query:o,params:d}=(0,B.kqP)({filter:s,query:u||"",types:r},{__unstable_extendedProjection:c,comments:["findability-source: ".concat(u?"list-query":"list")],limit:i,params:l,sort:a});return t.observable.fetch(o,d)}))}))})({client:l,filter:t,limit:o,params:n,schema:s,searchQuery:i||"",sort:a,staticTypeNames:z?[z]:void 0}).pipe((0,M.U)(e=>({result:{documents:e},error:null})),(0,L.O)(ei),(0,N.K)(e=>e instanceof ProgressEvent?(0,j._)(()=>Error("Request error")):(0,j._)(()=>e)),(0,N.K)((t,n)=>(0,E.z)((0,b.of)({result:null,error:t}),(0,_.T)((0,D.R)(window,"online"),e).pipe((0,C.q)(1),(0,g.z)(()=>n)))),(0,A.R)((e,t)=>({...e,...t,onRetry:u})))},[l,t,n,s,i,q,r,z]);(0,a.useEffect)(()=>{let e=Z.subscribe($);return()=>{e.unsubscribe()}},[$,Z]);let F=(0,a.useCallback)(()=>{T(!1),x(!1),o(er),W(!1)},[]);return(0,a.useEffect)(()=>{F()},[F,t,n,r,i]),{error:d,hasMaxItems:O,isLazyLoading:p,isLoading:I,isSearchReady:!d,items:h,onListChange:X,onRetry:c}}({apiVersion:V,filter:G,params:es,searchQuery:null==ep?void 0:ep.trim(),sortOrder:ew}),eI=(0,a.useMemo)(()=>ea({menuItems:Z,sortOrderRaw:e_,layout:em}),[em,Z,e_]),eO=(0,W.W2)(e=>e.pipe((0,M.U)(e=>e.target.value),(0,P.b)(eg),(0,T.D)(e=>""===e?(0,b.of)(""):(0,q.H)(300)),(0,P.b)(ex)),[]),eX=(0,a.useCallback)(()=>{ex(""),eg("")},[]),eB=(0,a.useCallback)(e=>{"Escape"===e.key&&eX()},[eX]);(0,a.useEffect)(()=>(!1!==ev.current||eP||(ev.current=!0),()=>{ev.current=!1}),[eP]),(0,a.useEffect)(()=>{eX(),ev.current=!1},[s,eX]);let e$=(0,a.useMemo)(()=>{let e=eP&&0===eq.length&&ev.current;return e?"spinner":"initial"},[eP,eq.length]),eL=(0,o.jsx)(c.xu,{paddingX:2,paddingBottom:2,children:(0,o.jsx)(eo,{radius:4,tone:"transparent",children:(0,o.jsx)(c.oi,{"aria-label":"Search list",autoComplete:"off",border:!1,clearButton:!!ep,disabled:!eT,fontSize:[2,2,1],icon:"spinner"===e$?eu:p.W1M,onChange:eO,onClear:eX,onKeyDown:eB,placeholder:"Search list",radius:2,ref:eb,spellCheck:!1,value:ey})})});return(0,o.jsx)(B.cWh,{name:ec||d,children:(0,o.jsxs)(z.X6,{currentMaxWidth:350,"data-ui":"DocumentListPane",id:s,maxWidth:640,minWidth:320,selected:i,children:[z.Oo,(0,o.jsx)(et,{contentAfter:eL,index:n,initialValueTemplates:x,menuItemGroups:$,menuItems:eI,setLayout:eh,setSortOrder:eC,title:U}),(0,o.jsx)(ee,{childItemId:t,error:eE,filterIsSimpleTypeConstraint:eR,hasMaxItems:eD,hasSearchQuery:!!ep,isActive:r,isLazyLoading:eM,isLoading:eP,items:eq,layout:em,loadingVariant:e$,onListChange:eW,onRetry:ez,searchInputElement:ej,showIcons:ef},s)]})})})}}]);